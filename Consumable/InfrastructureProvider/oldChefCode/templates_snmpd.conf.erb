# Generated by Chef on node <%= node['fqdn'] %>
# Local modifications will be overwritten.

agentAddress udp:161

createUser <%= node['snmp']['v3user'] %> MD5 <%= node['snmp']['v3pass'] %> DES <%= node['snmp']['v3key'] %>
rouser <%= node['snmp']['v3user'] %> priv

###############################################################################
# System contact information
#

<% if node['virtualization']['role'] == 'guest' %>
syslocation <%= node['snmp']['syslocationVirtual'] %>
<% else %>
syslocation <%= node['snmp']['syslocationPhysical'] %>
<% end %>
syscontact <%= node['snmp']['syscontact'] %>
sysName <%= node['snmp']['sysname'] %>

# Added for support of bcm5820 cards.
pass .1.3.6.1.4.1.4413.4.1 /usr/bin/ucd5820stat


###############################################################################
# Process monitoring
#
#  See the snmpd.conf manual page, and the output of "snmpd -H".
<% unless node['snmp']['process_monitoring']['proc'].empty? %>
  <% node['snmp']['process_monitoring']['proc'].each do |proc_entry| %>
proc <%= proc_entry %>
  <% end %>
<% end %>
<% unless node['snmp']['process_monitoring']['procfix'].empty? %>
  <% node['snmp']['process_monitoring']['procfix'].each do |procfix_entry| %>
procfix <%= procfix_entry %>
  <% end %>
<% end %>

# Disk Checks
#
# 
# When compiled with the ucd-snmp/disk module (included by default),
# the snmp agent can check the amount of available disk space and
# make sure it is above a set limit.

<% if node['snmp']['include_all_disks'] %>
includeAllDisks <%= node['snmp']['all_disk_min'] %>
<% end %>
<% unless node['snmp']['disks'].empty? %>
  <% node['snmp']['disks'].each do |disk| %>
disk <%= disk['mount'] %> <%= disk['min'] %>
  <% end %>
<% end %>

# Load Average Checks
#
# load [1MAX=DEFMAXLOADAVE] [5MAX=DEFMAXLOADAVE] [15MAX=DEFMAXLOADAVE]
#
# 1MAX:   If the 1 minute load average is above this limit at query
#         time, the errorFlag will be set.
# 5MAX:   Similar, but for 5 min average.
# 15MAX:  Similar, but for 15 min average.

<% unless node['snmp']['load_average'].empty? %>
<% load = node['snmp']['load_average'] %>
load <%= load['max1'] %> <%= load['max5'] %> <%= load['max15'] %>
<% end %>